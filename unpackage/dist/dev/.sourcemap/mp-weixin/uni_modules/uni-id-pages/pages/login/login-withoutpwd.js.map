{"version":3,"file":"login-withoutpwd.js","sources":["uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue","../../AAAloaddown/HBuilderX/plugins/uniapp-cli-vite/uniPage:/dW5pX21vZHVsZXMvdW5pLWlkLXBhZ2VzL3BhZ2VzL2xvZ2luL2xvZ2luLXdpdGhvdXRwd2QudnVl"],"sourcesContent":["<!-- 免密登录页 -->\r\n<template>\r\n\t<view class=\"uni-content animated-bg\">\r\n\t\t<!-- 动态背景元素 -->\r\n\t\t<view class=\"floating-bubble b1\"></view>\r\n\t\t<view class=\"floating-bubble b2\"></view>\r\n\t\t<view class=\"floating-bubble b3\"></view>\r\n\r\n\t\t<!-- 顶部文字 -->\r\n\t\t<text class=\"app-name\">码上识货铺</text>\r\n\t\t\r\n\t\t<!-- 顶部文字 -->\r\n\t\t<!-- 快捷登录框 当url带参数时有效 -->\r\n\t\t<template v-if=\"['apple','weixin', 'weixinMobile', 'huawei', 'huaweiMobile'].includes(type)\">\r\n\t\t\t<view class=\"quickLogin\">\r\n\t\t\t\t<image v-if=\"type !== 'weixinMobile' && type !== 'huaweiMobile'\" @click=\"quickLogin\" :src=\"imgSrc\"\r\n\t\t\t\t\tmode=\"widthFix\" class=\"quickLoginBtn\"></image>\r\n\t\t\t\t<view v-else style=\"position: relative\">\r\n\t\t\t\t\t<button v-if=\"type ==='weixinMobile'\" type=\"primary\" open-type=\"getPhoneNumber\"\r\n\t\t\t\t\t\t@getphonenumber=\"quickLogin\" class=\"uni-btn\">微信授权手机号登录</button>\r\n\t\t\t\t\t<button v-if=\"type === 'huaweiMobile'\" open-type=\"getPhoneNumber\" @getphonenumber=\"quickLogin\"\r\n\t\t\t\t\t\tclass=\"quickLoginBtn\" style=\"padding: 0; display: flex\">\r\n\t\t\t\t\t\t<image :src=\"imgSrc\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<view v-if=\"this.needAgreements && !this.agree\" class=\"mobile-login-agreement-layer\"\r\n\t\t\t\t\t\t@click=\"showAgreementModal\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\r\n\t\t\t</view>\r\n\t\t</template>\r\n\t\t<template v-else>\r\n\t\t\t<text class=\"tip\">未注册的账号验证通过后将自动注册</text>\r\n\t\t\t<view class=\"phone-box\">\r\n\t\t\t\t<view @click=\"chooseArea\" class=\"area\">+86</view>\r\n\t\t\t\t<uni-easyinput trim=\"both\" :focus=\"focusPhone\" @blur=\"focusPhone = false\" class=\"input-box\"\r\n\t\t\t\t\ttype=\"number\" :inputBorder=\"false\" v-model=\"phone\" maxlength=\"11\" placeholder=\"请输入手机号\" />\r\n\t\t\t</view>\r\n\t\t\t<uni-id-pages-agreements scope=\"register\" ref=\"agreements\"></uni-id-pages-agreements>\r\n\t\t\t<button class=\"uni-btn\" type=\"primary\" @click=\"toSmsPage\">获取验证码</button>\r\n\t\t</template>\r\n\t\t<!-- 固定定位的快捷登录按钮 -->\r\n\t\t<uni-id-pages-fab-login ref=\"uniFabLogin\"></uni-id-pages-fab-login>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tlet currentWebview; //当前窗口对象\r\n\timport config from '@/uni_modules/uni-id-pages/config.js'\r\n\timport mixin from '@/uni_modules/uni-id-pages/common/login-page.mixin.js';\r\n\texport default {\r\n\t\tmixins: [mixin],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"\", //快捷登录方式\r\n\t\t\t\tphone: \"\", //手机号码\r\n\t\t\t\tfocusPhone: false,\r\n\t\t\t\tlogo: \"/static/logo.png\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tasync loginTypes() { //读取配置的登录优先级\r\n\t\t\t\treturn config.loginTypes\r\n\t\t\t},\r\n\t\t\tisPhone() { //手机号码校验正则\r\n\t\t\t\treturn /^1\\d{10}$/.test(this.phone);\r\n\t\t\t},\r\n\t\t\timgSrc() { //大快捷登录按钮图\r\n\t\t\t\tconst images = {\r\n\t\t\t\t\tweixin: '/uni_modules/uni-id-pages/static/login/weixin.png',\r\n\t\t\t\t\tapple: '/uni_modules/uni-id-pages/static/app/apple.png',\r\n\t\t\t\t\thuawei: '/uni_modules/uni-id-pages/static/login/huawei.png',\r\n\t\t\t\t\thuaweiMobile: '/uni_modules/uni-id-pages/static/login/huawei-mobile.png',\r\n\t\t\t\t}\r\n\t\t\t\treturn images[this.type]\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onLoad(e) {\r\n\t\t\t//获取通过url传递的参数type设置当前登录方式，如果没传递直接默认以配置的登录\r\n\t\t\tlet type = e.type || config.loginTypes[0]\r\n\t\t\tthis.type = type\r\n\r\n\t\t\t// console.log(\"this.type: -----------\",this.type);\r\n\t\t\tif (type != 'univerify') {\r\n\t\t\t\tthis.focusPhone = true\r\n\t\t\t}\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t//关闭重复显示的登录快捷方式\r\n\t\t\t\tif (['weixin', 'apple', 'huawei', 'huaweiMobile'].includes(type)) {\r\n\t\t\t\t\tthis.$refs.uniFabLogin.servicesList = this.$refs.uniFabLogin.servicesList.filter(item =>\r\n\t\t\t\t\t\titem.id != type)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tuni.$on('uni-id-pages-setLoginType', type => {\r\n\t\t\t\tthis.type = type\r\n\t\t\t})\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\t// #ifdef H5\r\n\t\t\tdocument.onkeydown = event => {\r\n\t\t\t\tvar e = event || window.event;\r\n\t\t\t\tif (e && e.keyCode == 13) { //回车键的键值为13\r\n\t\t\t\t\tthis.toSmsPage()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tuni.$off('uni-id-pages-setLoginType')\r\n\t\t},\r\n\t\tonReady() {\r\n\t\t\t// 是否优先启动一键登录。即：页面一加载就启动一键登录\r\n\t\t\t//#ifdef APP-PLUS\r\n\t\t\tif (config.loginTypes.includes('univerify') && this.type == \"univerify\") {\r\n\t\t\t\tuni.preLogin({\r\n\t\t\t\t\tprovider: 'univerify',\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tconst pages = getCurrentPages();\r\n\t\t\t\t\t\tcurrentWebview = pages[pages.length - 1].$getAppWebview();\r\n\t\t\t\t\t\tcurrentWebview.setStyle({\r\n\t\t\t\t\t\t\t\"top\": \"2000px\" // 隐藏当前页面窗体\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// this.type == this.loginTypes[1]\r\n\t\t\t\t\t\t// console.log('开始一键登录');\r\n\t\t\t\t\t\tthis.$refs.uniFabLogin.login_before('univerify')\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\tif (config.loginTypes.length > 1) {\r\n\t\t\t\t\t\t\tthis.$refs.uniFabLogin.login_before(config.loginTypes[1])\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\tcontent: err.message,\r\n\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t//#endif\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowCurrentWebview() {\r\n\t\t\t\t// 恢复当前页面窗体的显示 一键登录，默认不显示当前窗口\r\n\t\t\t\tcurrentWebview.setStyle({\r\n\t\t\t\t\t\"top\": 0\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tshowAgreementModal() {\r\n\t\t\t\tthis.$refs.agreements.popup()\r\n\t\t\t},\r\n\t\t\tquickLogin(e) {\r\n\t\t\t\tlet options = {}\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t\tif (e.detail?.code) {\r\n\t\t\t\t\toptions.phoneNumberCode = e.detail.code\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ((this.type === 'weixinMobile' || this.type === 'huaweiMobile') && !e.detail?.code) return\r\n\r\n\t\t\t\tthis.$refs.uniFabLogin.login_before(this.type, true, options)\r\n\t\t\t},\r\n\t\t\ttoSmsPage() {\r\n\t\t\t\tif (!this.isPhone) {\r\n\t\t\t\t\tthis.focusPhone = true\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: \"手机号码格式不正确\",\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (this.needAgreements && !this.agree) {\r\n\t\t\t\t\treturn this.$refs.agreements.popup(this.toSmsPage)\r\n\t\t\t\t}\r\n\t\t\t\t// 发送验证吗\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-smscode?phoneNumber=' + this.phone\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//去密码登录页\r\n\t\t\ttoPwdLogin() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '../login/password'\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchooseArea() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '暂不支持其他国家',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 3000\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\n/* 通用样式 */\n.uni-content {\n  height: 100vh;\n  background: linear-gradient(135deg, #1a73e8, #2196F3);\n  overflow: hidden;\n  position: relative;\n}\n\n.floating-bubble {\n  position: absolute;\n  background: rgba(255,255,255,0.1);\n  border-radius: 50%;\n  animation: float 8s infinite linear;\n  opacity: 0.8;\n  \n  &.b1 {\n    width: 200rpx;\n    height: 200rpx;\n    left: 15%;\n    top: 20%;\n    animation: float 6s infinite linear;\n    animation-delay: 0.5s;\n  }\n  &.b2 {\n    width: 150rpx;\n    height: 150rpx;\n    right: 15%;\n    top: 35%;\n    animation: float 8s infinite linear;\n  }\n  &.b3 {\n    width: 180rpx;\n    height: 180rpx;\n    left: 25%;\n    top: 65%;\n    animation: float 7s infinite linear;\n    animation-delay: 1.5s;\n  }\n}\n\n@keyframes float {\n  0% {\n    transform: translateY(0) translateX(0) scale(1);\n    opacity: 0.8;\n  }\n  33% {\n    transform: translateY(-100rpx) translateX(30rpx) scale(0.9);\n  }\n  66% {\n    transform: translateY(50rpx) translateX(-20rpx) scale(1.1);\n  }\n  100% {\n    transform: translateY(0) translateX(0) scale(1);\n    opacity: 0.4;\n  }\n}\n.app-name {\n  display: block;\n  text-align: center;\n  color: #fff;\n  font-size: 62rpx;\n  font-weight: bold;\n  text-shadow: \n    0 4rpx 8rpx rgba(0,0,0,0.2),\n    0 0 20rpx rgba(255,255,255,0.3);\n\n  margin: 600rpx 0 0;\n  position: relative;\n  z-index: 2;\n}\n\r\n\n/* 登录按钮居中样式 */\n.quickLogin {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  margin-top: 80rpx;\n  \n  .quickLoginBtn {\n    width: 500rpx;\n    margin: 0 auto;\n    animation: btnScale 1.5s infinite ease-in-out;\n    position: relative;\n    transition: transform 0.3s;\n    \n    &:active {\n      transform: scale(0.95);\n    }\n  }\n}\n\n@keyframes btnScale {\n  0%, 100% {\n    transform: scale(1);\n    box-shadow: 0 10rpx 30rpx rgba(33, 150, 243, 0.3);\n  }\n  50% {\n    transform: scale(1.02);\n    box-shadow: 0 15rpx 40rpx rgba(33, 150, 243, 0.5);\n  }\n}\n\n/* 手机号登录部分居中 */\n.phone-box {\n  width: 80%;\n  margin: 40rpx auto;\n}\n\n.uni-btn {\n  display: block;\n  width: 500rpx;\n  margin: 40rpx auto;\n}\n</style>","import MiniProgramPage from 'D:/weixin_pj/扫一扫/uni_modules/uni-id-pages/pages/login/login-withoutpwd.vue'\nwx.createPage(MiniProgramPage)"],"names":["mixin","config","uni","type"],"mappings":";;;;AA8CC,IAAI;AAGJ,MAAK,YAAU;AAAA,EACd,QAAQ,CAACA,8CAAAA,KAAK;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,MAAM;AAAA;AAAA,MACN,OAAO;AAAA;AAAA,MACP,YAAY;AAAA,MACZ,MAAM;AAAA,IACP;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,MAAM,aAAa;AAClB,aAAOC,8BAAM,OAAC;AAAA,IACd;AAAA,IACD,UAAU;AACT,aAAO,YAAY,KAAK,KAAK,KAAK;AAAA,IAClC;AAAA,IACD,SAAS;AACR,YAAM,SAAS;AAAA,QACd,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,cAAc;AAAA,MACf;AACA,aAAO,OAAO,KAAK,IAAI;AAAA,IACxB;AAAA,EACA;AAAA,EACD,MAAM,OAAO,GAAG;AAEf,QAAI,OAAO,EAAE,QAAQA,8BAAAA,OAAO,WAAW,CAAC;AACxC,SAAK,OAAO;AAGZ,QAAI,QAAQ,aAAa;AACxB,WAAK,aAAa;AAAA,IACnB;AACA,SAAK,UAAU,MAAM;AAEpB,UAAI,CAAC,UAAU,SAAS,UAAU,cAAc,EAAE,SAAS,IAAI,GAAG;AACjE,aAAK,MAAM,YAAY,eAAe,KAAK,MAAM,YAAY,aAAa,OAAO,UAChF,KAAK,MAAM,IAAI;AAAA,MACjB;AAAA,KACA;AACDC,wBAAI,IAAI,6BAA6B,CAAAC,UAAQ;AAC5C,WAAK,OAAOA;AAAA,KACZ;AAAA,EACD;AAAA,EACD,SAAS;AAAA,EASR;AAAA,EACD,WAAW;AACVD,kBAAG,MAAC,KAAK,2BAA2B;AAAA,EACpC;AAAA,EACD,UAAU;AAAA,EA8BT;AAAA,EACD,SAAS;AAAA,IACR,qBAAqB;AAEpB,qBAAe,SAAS;AAAA,QACvB,OAAO;AAAA,OACP;AAAA,IACD;AAAA,IACD,qBAAqB;AACpB,WAAK,MAAM,WAAW,MAAM;AAAA,IAC5B;AAAA,IACD,WAAW,GAAG;;AACb,UAAI,UAAU,CAAC;AACfA,oBAAAA,MAAY,MAAA,OAAA,oEAAA,CAAC;AACb,WAAI,OAAE,WAAF,mBAAU,MAAM;AACnB,gBAAQ,kBAAkB,EAAE,OAAO;AAAA,MACpC;AAEA,WAAK,KAAK,SAAS,kBAAkB,KAAK,SAAS,mBAAmB,GAAC,OAAE,WAAF,mBAAU;AAAM;AAEvF,WAAK,MAAM,YAAY,aAAa,KAAK,MAAM,MAAM,OAAO;AAAA,IAC5D;AAAA,IACD,YAAY;AACX,UAAI,CAAC,KAAK,SAAS;AAClB,aAAK,aAAa;AAClB,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAC;AAAA,MACF;AACA,UAAI,KAAK,kBAAkB,CAAC,KAAK,OAAO;AACvC,eAAO,KAAK,MAAM,WAAW,MAAM,KAAK,SAAS;AAAA,MAClD;AAEAA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,qEAAqE,KAAK;AAAA,MAChF,CAAC;AAAA,IACD;AAAA;AAAA,IAED,aAAa;AACZA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,OACL;AAAA,IACD;AAAA,IACD,aAAa;AACZA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,QACN,UAAU;AAAA,MACX,CAAC;AAAA,IACD;AAAA,EACF;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC/LD,GAAG,WAAW,eAAe;"}