{"version":3,"file":"list.js","sources":["pages/list/list.vue","../../AAAloaddown/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbGlzdC9saXN0LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"goods-list-page\">\r\n\t\t<!-- 直接在页面中展示商品列表，不使用 scroll-view -->\r\n\t\t<view v-if=\"goodsList.length > 0\">\r\n\t\t\t<view class=\"goods-item\" v-for=\"item in goodsList\" :key=\"item._id\" @click=\"showGoodsDetail(item)\">\r\n\t\t\t\t<goods-item :item=\"item\"></goods-item>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 加载更多 -->\r\n\t\t\t<view class=\"load-more\" v-if=\"isLoading\">\r\n\t\t\t\t<text class=\"loading-text\">加载中...</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"no-more\" v-else>\r\n\t\t\t\t<text class=\"no-more-text\">没有更多了</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"nothing\" v-else-if=\"goodsList.length === 0 && isLoading\">\r\n\t\t\t<text class=\"font\">加载中...</text>\r\n\t\t</view>\r\n\t\t<view class=\"nothing\" v-else-if=\"goodsList.length === 0 && !isLoading\">\r\n\t\t\t<text class=\"font\">--您还未添加商品--</text>\r\n\t\t\t<image class=\"empty-icon\"\r\n\t\t\t\tsrc=\"https://env-00jxt6l7w3we.normal.cloudstatic.cn/showPic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-23%20135635.png\">\r\n\t\t\t</image>\r\n\t\t</view>\r\n\r\n\t\t<!-- 商品详情弹窗 -->\r\n\t\t<goods-popup :show=\"showPopup\" :goods=\"currentGoods\" @update:show=\"showPopup = $event\" @refresh=\"refreshList\" />\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tconst goodsCloudObj = uniCloud.importObject('goodsInfoObj');\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tgoodsList: [], // 存储商品列表数据\r\n\t\t\t\tpage: 1, // 当前页码\r\n\t\t\t\tpageSize: 20, // 每页数据量\r\n\t\t\t\tisLoading: false, // 是否正在加载数据\r\n\t\t\t\tisNoMore: false, // 是否已经没有更多数据\r\n\t\t\t\tshowPopup: false,\r\n\t\t\t\tcurrentGoods: {}\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.getGoods();\r\n\t\t},\r\n\t\tonPullDownRefresh() {\r\n\t\t\tconsole.log(123);\r\n\t\t\tthis.page = 1;\r\n\t\t\tthis.pageSize = 20;\r\n\t\t\tthis.goodsList = []\r\n\t\t\tthis.isNoMore = false\r\n\t\t\tthis.getGoods();\r\n\t\t},\r\n\t\tonReachBottom() {\r\n\t\t\tconsole.log('bottom')\r\n\t\t\tthis.getGoods();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync getGoods() {\r\n\t\t\t\tif (this.isLoading || this.isNoMore) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.isLoading = true;\r\n\t\t\t\tconst result = await goodsCloudObj.getGoodsList({\r\n\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\tpageSize: this.pageSize\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (result.code === 0) {\r\n\t\t\t\t\tif (result.data.length < this.pageSize) {\r\n\t\t\t\t\t\tthis.isNoMore = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.goodsList = [...this.goodsList, ...result.data];\r\n\t\t\t\t\tthis.page++;\r\n\t\t\t\t} else if (result.code === -1) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '未登录/登录过期',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-withoutpwd'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t\treturn\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: result.msg,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t// 数据获取完成，停止下拉刷新动画\r\n\t\t\t\tuni.stopPullDownRefresh();\r\n\t\t\t\tthis.isLoading = false;\r\n\t\t\t},\r\n\r\n\t\t\tshowGoodsDetail(goods) {\r\n\t\t\t\tthis.currentGoods = goods;\r\n\t\t\t\tthis.showPopup = true;\r\n\t\t\t},\r\n\t\t\trefreshList() {\r\n\t\t\t\tthis.page = 1;\r\n\t\t\t\tthis.pageSize = 20;\r\n\t\t\t\tthis.goodsList = []\r\n\t\t\t\tthis.isNoMore = false\r\n\t\t\t\tthis.getGoods();\r\n\t\t\t\tthis.showPopup = false;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.goods-list-page {\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\r\n\t.goods-item {\r\n\t\tborder: 1rpx solid #ccc;\r\n\t\tpadding: 10rpx;\r\n\t\tborder-radius: 20rpx;\r\n\t\tmargin-bottom: 10rpx;\r\n\t}\r\n\r\n\t.nothing {\r\n\t\tpadding: 30rpx 0;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tflex-direction: column;\r\n\t}\r\n\r\n\t.font {\r\n\t\tfont-size: 38rpx;\r\n\t\tcolor: #c7ccd7;\r\n\t}\r\n\r\n\t.empty-icon {\r\n\t\twidth: 500rpx;\r\n\t\theight: 500rpx;\r\n\t}\r\n\r\n\t.load-more,\r\n\t.no-more {\r\n\t\ttext-align: center;\r\n\t\tpadding: 30rpx 0;\r\n\t}\r\n\r\n\t.loading-text,\r\n\t.no-more-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/weixin_pj/扫一扫/pages/list/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","uni"],"mappings":";;AAiCC,MAAM,gBAAgBA,cAAQ,GAAC,aAAa,cAAc;AAC1D,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,WAAW,CAAE;AAAA;AAAA,MACb,MAAM;AAAA;AAAA,MACN,UAAU;AAAA;AAAA,MACV,WAAW;AAAA;AAAA,MACX,UAAU;AAAA;AAAA,MACV,WAAW;AAAA,MACX,cAAc,CAAC;AAAA;EAEhB;AAAA,EACD,SAAS;AACR,SAAK,SAAQ;AAAA,EACb;AAAA,EACD,oBAAoB;AACnBC,kBAAAA,MAAY,MAAA,OAAA,6BAAA,GAAG;AACf,SAAK,OAAO;AACZ,SAAK,WAAW;AAChB,SAAK,YAAY,CAAC;AAClB,SAAK,WAAW;AAChB,SAAK,SAAQ;AAAA,EACb;AAAA,EACD,gBAAgB;AACfA,kBAAAA,MAAY,MAAA,OAAA,6BAAA,QAAQ;AACpB,SAAK,SAAQ;AAAA,EACb;AAAA,EACD,SAAS;AAAA,IACR,MAAM,WAAW;AAChB,UAAI,KAAK,aAAa,KAAK,UAAU;AACpC;AAAA,MACD;AACA,WAAK,YAAY;AACjB,YAAM,SAAS,MAAM,cAAc,aAAa;AAAA,QAC/C,MAAM,KAAK;AAAA,QACX,UAAU,KAAK;AAAA,MAChB,CAAC;AAED,UAAI,OAAO,SAAS,GAAG;AACtB,YAAI,OAAO,KAAK,SAAS,KAAK,UAAU;AACvC,eAAK,WAAW;AAAA,QACjB;AACA,aAAK,YAAY,CAAC,GAAG,KAAK,WAAW,GAAG,OAAO,IAAI;AACnD,aAAK;AAAA,MACJ,WAAS,OAAO,SAAS,IAAI;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AACD,aAAK,YAAY;AACjBA,sBAAG,MAAC,oBAAmB;AACvB,mBAAW,MAAM;AAChBA,wBAAAA,MAAI,WAAW;AAAA,YACd,KAAK;AAAA,WACL;AAAA,QACD,GAAE,GAAI;AACP;AAAA,aACM;AACNA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO,OAAO;AAAA,UACd,MAAM;AAAA,QACP,CAAC;AAAA,MACF;AAEAA,oBAAG,MAAC,oBAAmB;AACvB,WAAK,YAAY;AAAA,IACjB;AAAA,IAED,gBAAgB,OAAO;AACtB,WAAK,eAAe;AACpB,WAAK,YAAY;AAAA,IACjB;AAAA,IACD,cAAc;AACb,WAAK,OAAO;AACZ,WAAK,WAAW;AAChB,WAAK,YAAY,CAAC;AAClB,WAAK,WAAW;AAChB,WAAK,SAAQ;AACb,WAAK,YAAY;AAAA,IAClB;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjHF,GAAG,WAAW,eAAe;"}