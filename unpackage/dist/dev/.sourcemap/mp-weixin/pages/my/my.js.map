{"version":3,"file":"my.js","sources":["pages/my/my.vue","../../AAAloaddown/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbXkvbXkudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 用户信息卡片 -->\r\n\t\t<view class=\"user-card\">\r\n\t\t\t<view class=\"avatar-section\" @click=\"changeAvatar\">\r\n\t\t\t\t<image class=\"avatar\" :src=\"userInfo.avatar_file || '/static/default-avatar.png'\" mode=\"aspectFill\">\r\n\t\t\t\t</image>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"user-info\">\r\n\t\t\t\t<view class=\"nickname-wrapper\" @click=\"showNicknameInput\">\r\n\t\t\t\t\t<text class=\"nickname\">{{ userInfo.nickname || '未登录' }}</text>\r\n\t\t\t\t\t<text class=\"iconfont icon-edit\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 功能列表 -->\r\n\t\t<view class=\"feature-list\">\r\n\t\t\t<view class=\"feature-item\" @click=\"handleModel\">\r\n\t\t\t\t<text class=\"iconfont icon-import\"></text>\r\n\t\t\t\t<text class=\"feature-text\">导入模板以及导入说明</text>\r\n\t\t\t\t<text class=\"iconfont icon-right\"></text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"feature-item\" @click=\"handleImport\">\r\n\t\t\t\t<text class=\"iconfont icon-import\"></text>\r\n\t\t\t\t<text class=\"feature-text\">导入Excel</text>\r\n\t\t\t\t<text class=\"iconfont icon-right\"></text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"feature-item\" @click=\"handleExport\">\r\n\t\t\t\t<text class=\"iconfont icon-export\"></text>\r\n\t\t\t\t<text class=\"feature-text\">导出Excel</text>\r\n\t\t\t\t<text class=\"iconfont icon-right\"></text>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"feature-item\" @click=\"showFeedback\">\r\n\t\t\t\t<text class=\"iconfont icon-feedback\"></text>\r\n\t\t\t\t<text class=\"feature-text\">意见反馈</text>\r\n\t\t\t\t<text class=\"iconfont icon-right\"></text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 修改昵称弹窗 -->\r\n\t\t<uni-popup ref=\"nicknamePopup\" type=\"center\">\r\n\t\t\t<view class=\"popup-content\">\r\n\t\t\t\t<view class=\"popup-title\">修改昵称</view>\r\n\t\t\t\t<input class=\"nickname-input\" v-model=\"newNickname\" placeholder=\"请输入新昵称\" maxlength=\"12\" />\r\n\t\t\t\t<view class=\"popup-buttons\">\r\n\t\t\t\t\t<button class=\"cancel-btn\" @click=\"closeNicknamePopup\">取消</button>\r\n\t\t\t\t\t<button class=\"confirm-btn\" @click=\"updateNickname\">确认</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\r\n\t\t<!-- 意见反馈弹窗 -->\r\n\t\t<uni-popup ref=\"feedbackPopup\" type=\"center\">\r\n\t\t\t<view class=\"popup-content\">\r\n\t\t\t\t<view class=\"popup-title\">意见反馈</view>\r\n\t\t\t\t<textarea class=\"mobile-input\" v-model=\"mobile\" placeholder=\"请输入您的电话，方便与您联系\" />\r\n\t\t\t\t<textarea class=\"feedback-input\" v-model=\"feedbackContent\" placeholder=\"请输入您的意见或建议\" maxlength=\"500\" />\r\n\t\t\t\t<view class=\"popup-buttons\">\r\n\t\t\t\t\t<button class=\"cancel-btn\" @click=\"closeFeedbackPopup\">取消</button>\r\n\t\t\t\t\t<button class=\"confirm-btn\" @click=\"submitFeedback\">提交</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\r\n\t\t<uni-popup ref=\"exportPopup\" type=\"center\">\r\n\t\t\t<view class=\"popup-content\">\r\n\t\t\t\t<view class=\"popup-title\">复制成功√</view>\r\n\t\t\t\t<view class=\"export-content\">您已复制下载连接，请粘贴到【浏览器】中下载。当前连接10分钟后过期</view>\r\n\t\t\t\t<input class=\"tmpurl-input\" v-model=\"tmpurl\" />\r\n\t\t\t\t<view class=\"popup-buttons\">\r\n\t\t\t\t\t<button class=\"confirm-btn\" @click=\"coypContent\">复制</button>\r\n\t\t\t\t\t<button class=\"confirm-btn\" @click=\"closeexportPopup\">好的</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tconst db = uniCloud.database()\r\n\tconst goodsExportImport = uniCloud.importObject('goodsExportImport')\r\n\timport * as XLSX from 'xlsx';\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tuserInfo: {},\r\n\t\t\t\tnewNickname: '',\r\n\t\t\t\tfeedbackContent: '',\r\n\t\t\t\tmobile: '',\r\n\t\t\t\ttmpurl: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.getUserInfo()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\thandleModel() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: \"/pages/subpack/explanation/explanation\"\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tisJSON(str) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tJSON.parse(str);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgotoLogin() {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '未登录/登录过期',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: '../../uni_modules/uni-id-pages/pages/login/login-withoutpwd'\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 1000)\r\n\t\t\t},\r\n\r\n\t\t\tasync getUserInfo() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet userInfo = uni.getStorageSync('uni-id-pages-userInfo')\r\n\t\t\t\t\tif (this.isJSON(userInfo)) {\r\n\t\t\t\t\t\tuserInfo = JSON.parse(userInfo)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.userInfo = userInfo || {}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('获取用户信息时发生错误:', error);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\r\n\t\t\tshowNicknameInput() {\r\n\t\t\t\tconsole.log(this.userInfo.nickname)\r\n\t\t\t\tif (typeof this.userInfo.nickname === 'undefined') {\r\n\t\t\t\t\tconsole.log(this.userInfo.nickname)\r\n\t\t\t\t\tthis.gotoLogin()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tthis.newNickname = this.userInfo.nickname || '未知'\r\n\t\t\t\tthis.$refs.nicknamePopup.open()\r\n\t\t\t},\r\n\r\n\t\t\tcloseNicknamePopup() {\r\n\t\t\t\tthis.$refs.nicknamePopup.close()\r\n\t\t\t},\r\n\r\n\r\n\t\t\tchangeAvatar() {\r\n\t\t\t\tif (typeof this.userInfo.avatar_file === 'undefined') {\r\n\t\t\t\t\tthis.gotoLogin()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\tsizeType: ['compressed'],\r\n\t\t\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\t\tconst tempFilePath = res.tempFilePaths[0]\r\n\r\n\t\t\t\t\t\t// 显示上传中提示\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: '上传中...'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tconsole.log(tempFilePath)\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t// 上传图片到云存储\r\n\t\t\t\t\t\t\tconst uploadRes = await uniCloud.uploadFile({\r\n\t\t\t\t\t\t\t\tfilePath: tempFilePath,\r\n\t\t\t\t\t\t\t\tcloudPath: `avatar/${Date.now()}_${Math.random().toString(36).substring(2, 8)}.jpg`\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tconst tempFileURL = await uniCloud.getTempFileURL({\r\n\t\t\t\t\t\t\t\tfileList: [uploadRes.fileID]\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\tlet avatarUrl = tempFileURL.fileList[0].tempFileURL\r\n\r\n\t\t\t\t\t\t\tconst questionMarkIndex = avatarUrl.indexOf('?');\r\n\t\t\t\t\t\t\tif (questionMarkIndex !== -1) {\r\n\t\t\t\t\t\t\t\tavatarUrl = avatarUrl.substring(0, questionMarkIndex);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// 更新用户信息\r\n\t\t\t\t\t\t\tawait db.collection('uni-id-users').doc(this.userInfo._id).update({\r\n\t\t\t\t\t\t\t\tavatar_file: avatarUrl\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t// 更新本地存储\r\n\t\t\t\t\t\t\tthis.userInfo.avatar_file = avatarUrl\r\n\r\n\r\n\t\t\t\t\t\t\tuni.setStorageSync('uni-id-pages-userInfo', JSON.stringify(this.userInfo))\r\n\r\n\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '头像更新成功',\r\n\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tconsole.error('头像更新失败:', e)\r\n\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: e.message || '上传失败',\r\n\t\t\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tconsole.error('选择图片失败:', err)\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '选择图片失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tasync updateNickname() {\r\n\t\t\t\tif (!this.newNickname.trim()) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '昵称不能为空',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tconsole.log(this.userInfo._id)\r\n\t\t\t\t\tawait db.collection('uni-id-users').where('_id==$env.uid').update({\r\n\t\t\t\t\t\tnickname: this.newNickname\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tthis.userInfo.nickname = this.newNickname\r\n\t\t\t\t\tuni.setStorageSync('uni-id-pages-userInfo', JSON.stringify(this.userInfo))\r\n\r\n\t\t\t\t\tthis.closeNicknamePopup()\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '昵称更新成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '更新失败',\r\n\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tasync handleImport() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// 选择文件\r\n\t\t\t\t\tconst chooseRes = await uni.chooseMessageFile({\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttype: 'file',\r\n\t\t\t\t\t\textension: ['xlsx', '.xlsx']\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tconst filePath = chooseRes.tempFiles[0].path\r\n\r\n\t\t\t\t\t// 创建文件系统管理器\r\n\t\t\t\t\tconst fs = wx.getFileSystemManager();\r\n\r\n\t\t\t\t\t// 读取文件内容\r\n\t\t\t\t\tlet fileData;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tfileData = fs.readFileSync(filePath, 'base64');\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '读取文件失败',\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 使用 xlsx 解析 Excel 文件\r\n\t\t\t\t\tconst workbook = XLSX.read(fileData, {\r\n\t\t\t\t\t\ttype: 'base64'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tconst worksheet = workbook.Sheets[workbook.SheetNames[0]];\r\n\r\n\t\t\t\t\t// 将工作表转换为 JSON 数据\r\n\t\t\t\t\tconst jsonData = XLSX.utils.sheet_to_json(worksheet, {\r\n\t\t\t\t\t\theader: 1\r\n\t\t\t\t\t});\r\n\t\t\t\t\tjsonData.shift()\r\n\r\n\t\t\t\t\tconsole.log(jsonData)\r\n\r\n\t\t\t\t\t// 检查 goods_price 列是否包含非数字\r\n\t\t\t\t\tconst hasNonNumericPrice = jsonData.some(row => {\r\n\t\t\t\t\t\tconst price = row[2];\r\n\t\t\t\t\t\treturn !(typeof price === 'number' && !isNaN(price) && Number(price) >= 0);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// 检查名字是否有空\r\n\t\t\t\t\tconst hasEmptyName = jsonData.some(row => {\r\n\t\t\t\t\t\tconst name = row[1];\r\n\t\t\t\t\t\treturn !name || name.trim() === '';\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tconst hasNum = jsonData.some(row => {\r\n\t\t\t\t\t\tconst num = row[3]\r\n\t\t\t\t\t\treturn !(num === '' || num === null || num === undefined || (typeof num ===\r\n\t\t\t\t\t\t\t'number' && !isNaN(num) && Number(num) >= 0))\r\n\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t\tif (hasNonNumericPrice) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '价格列包含非数字或者负数,请修改后重新上传',\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else if (hasEmptyName) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '商品名称不能为空',\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else if (hasNum) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '数量列包含非数字或者负数,请修改后重新上传',\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// console.log(hasNonNumericPrice,hasEmptyName)\r\n\t\t\t\t\tconsole.log(jsonData)\r\n\r\n\t\t\t\t\t// 调用云对象处理数据\r\n\t\t\t\t\tconst res = await goodsExportImport.importGoods(jsonData);\r\n\t\t\t\t\tconsole.log('返回', res)\r\n\t\t\t\t\tif (res.code === 500) {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else if (res.code === -1) {\r\n\t\t\t\t\t\tthis.gotoLogin()\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.log(error)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\r\n\r\n\t\t\tasync handleExport() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst res = await goodsExportImport.exportGoods();\r\n\t\t\t\t\tif (res.code === 200) {\r\n\t\t\t\t\t\tthis.tmpurl = res.downloadUrl\r\n\t\t\t\t\t\tthis.$refs.exportPopup.open()\r\n\t\t\t\t\t\tthis.coypContent(this.tmpurl)\r\n\t\t\t\t\t} else if (res.code === -1) {\r\n\t\t\t\t\t\tthis.gotoLogin()\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '导出失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '导出失败',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tcoypContent() {\r\n\t\t\t\tuni.setClipboardData({\r\n\t\t\t\t\tdata: this.tmpurl,\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '复制成功',\r\n\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '复制失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tcloseexportPopup() {\r\n\t\t\t\tthis.$refs.exportPopup.close()\r\n\t\t\t},\r\n\r\n\t\t\tasync showFeedback() {\r\n\t\t\t\tconst res = await goodsExportImport.checkLogin()\r\n\t\t\t\tconsole.log(res.code)\r\n\t\t\t\tif (res.code === -1) {\r\n\t\t\t\t\tthis.gotoLogin()\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tthis.$refs.feedbackPopup.open()\r\n\t\t\t},\r\n\t\t\tcloseFeedbackPopup() {\r\n\t\t\t\tthis.$refs.feedbackPopup.close()\r\n\t\t\t\tthis.feedbackContent = ''\r\n\t\t\t},\r\n\t\t\tasync submitFeedback() {\r\n\t\t\t\tconst regex = /^1[3-9]\\d{9}$/;\r\n\t\t\t\tif (!this.feedbackContent.trim()) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入反馈内容',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t} else if (this.mobile === '') {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '手机号不能为空',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t} else if (!regex.test(this.mobile)) {\r\n\t\t\t\t\tconsole.log(this.mobile);\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入有效的手机号',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst res = await db.collection('opendb-feedback').add({\r\n\t\t\t\t\t\tuser_id: this.userInfo._id,\r\n\t\t\t\t\t\tcontent: this.feedbackContent,\r\n\t\t\t\t\t\tmobile: this.mobile,\r\n\t\t\t\t\t\tcreate_date: Date.now()\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tconsole.log(res)\r\n\r\n\t\t\t\t\tthis.closeFeedbackPopup()\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '反馈提交成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交失败',\r\n\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.container {\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: #f5f5f5;\r\n\t\tpadding: 30rpx;\r\n\t}\r\n\r\n\t.user-card {\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 40rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.avatar-section {\r\n\t\tposition: relative;\r\n\t\tmargin-right: 30rpx;\r\n\t}\r\n\r\n\t.avatar {\r\n\t\twidth: 120rpx;\r\n\t\theight: 120rpx;\r\n\t\tborder-radius: 60rpx;\r\n\t\tbackground: #eee;\r\n\t}\r\n\r\n\t.edit-badge {\r\n\t\tposition: absolute;\r\n\t\tright: -6rpx;\r\n\t\tbottom: -6rpx;\r\n\t\twidth: 40rpx;\r\n\t\theight: 40rpx;\r\n\t\tbackground: #007AFF;\r\n\t\tborder-radius: 20rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.edit-badge .icon-camera {\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\r\n\t.user-info {\r\n\t\tflex: 1;\r\n\t}\r\n\r\n\t.nickname-wrapper {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.nickname {\r\n\t\tfont-size: 36rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: 500;\r\n\t\tmargin-right: 16rpx;\r\n\t}\r\n\r\n\t.icon-edit {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.feature-list {\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tbox-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.05);\r\n\t}\r\n\r\n\t.feature-item {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 30rpx 20rpx;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t}\r\n\r\n\t.feature-item:last-child {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t.feature-item .iconfont {\r\n\t\tfont-size: 40rpx;\r\n\t\tcolor: #007AFF;\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\r\n\t.feature-item .icon-right {\r\n\t\tmargin-left: auto;\r\n\t\tcolor: #999;\r\n\t\tfont-size: 32rpx;\r\n\t}\r\n\r\n\t.feature-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.popup-content {\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 20rpx;\r\n\t\twidth: 600rpx;\r\n\t\tpadding: 30rpx;\r\n\t}\r\n\r\n\t.export-content {\r\n\t\tmargin-bottom: 25rpx;\r\n\t}\r\n\r\n\t.popup-title {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: 500;\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\r\n\t.nickname-input {\r\n\t\theight: 80rpx;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\r\n\t.tmpurl-input {\r\n\t\twidth: 100%;\r\n\t\theight: 80rpx;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.mobile-input {\r\n\t\twidth: 100%;\r\n\t\theight: 80rpx;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\r\n\t.feedback-input {\r\n\t\theight: 300rpx;\r\n\t\twidth: 100%;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-radius: 8rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.popup-buttons {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.popup-buttons button {\r\n\t\twidth: 260rpx;\r\n\t\theight: 80rpx;\r\n\t\tborder-radius: 8rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.cancel-btn {\r\n\t\tbackground: #f5f5f5;\r\n\t\tcolor: #666;\r\n\t}\r\n\r\n\t.confirm-btn {\r\n\t\tbackground: #007AFF;\r\n\t\tcolor: #fff;\r\n\t}\r\n\r\n\t/* 添加动画效果 */\r\n\t.user-card {\r\n\t\tanimation: slideDown 0.5s ease-out;\r\n\t}\r\n\r\n\t.feature-list {\r\n\t\tanimation: slideUp 0.5s ease-out;\r\n\t}\r\n\r\n\t@keyframes slideDown {\r\n\t\tfrom {\r\n\t\t\topacity: 0;\r\n\t\t\ttransform: translateY(-20rpx);\r\n\t\t}\r\n\r\n\t\tto {\r\n\t\t\topacity: 1;\r\n\t\t\ttransform: translateY(0);\r\n\t\t}\r\n\t}\r\n\r\n\t@keyframes slideUp {\r\n\t\tfrom {\r\n\t\t\topacity: 0;\r\n\t\t\ttransform: translateY(20rpx);\r\n\t\t}\r\n\r\n\t\tto {\r\n\t\t\topacity: 1;\r\n\t\t\ttransform: translateY(0);\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/weixin_pj/扫一扫/pages/my/my.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","uni","wx","XLSX.read","XLSX.utils"],"mappings":"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"}