{"version":3,"file":"home.js","sources":["pages/home/home.vue","../../AAAloaddown/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaG9tZS9ob21lLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<!-- 搜索框 -->\r\n\t\t<view class=\"search-box\" @click=\"goToSearch\">\r\n\t\t\t<text class=\"iconfont icon-search\"></text>\r\n\t\t\t<text class=\"placeholder\">搜索商品</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 扫描按钮 -->\r\n\t\t<view class=\"scan-section\">\r\n\t\t\t<view class=\"scan-button\" @click=\"startScan\">\r\n\t\t\t\t<text class=\"iconfont icon-scan\"></text>\r\n\t\t\t\t<text class=\"scan-text\">扫描商品</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 添加按钮 -->\r\n\t\t<view class=\"scan-section\">\r\n\t\t\t<view class=\"scan-button\" @click=\"popopen\">\r\n\t\t\t\t<text class=\"iconfont icon-scan\"></text>\r\n\t\t\t\t<text class=\"scan-text\">添加商品</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<!-- 商品信息弹窗 -->\r\n\t\t<goods-popup :show=\"showGoodsPopup\" :goods=\"currentGoods\" @update:show=\"showGoodsPopup = $event\"\r\n\t\t\t@refresh=\"refreshGoods\" />\r\n\r\n\t\t<!-- 添加商品弹窗 -->\r\n\t\t<uni-popup ref=\"addPopup\" type=\"center\">\r\n\t\t\t<view class=\"add-popup\">\r\n\t\t\t\t<view class=\"add-header\">\r\n\t\t\t\t\t<text class=\"add-title\">添加商品</text>\r\n\t\t\t\t\t<text class=\"close-btn\" @click=\"closeAddPopup\">×</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"add-body\">\r\n\t\t\t\t\t<input v-model=\"newGoods.goods_sn\" class=\"add-input\" placeholder=\"商品条形码\" />\r\n\t\t\t\t\t<input v-model=\"newGoods.goods_name\" class=\"add-input\" placeholder=\"商品名称\" />\r\n\t\t\t\t\t<input v-model=\"newGoods.goods_price\" class=\"add-input\" type=\"digit\" placeholder=\"商品价格\" />\r\n\t\t\t\t\t<input v-model=\"newGoods.goods_notes\" class=\"add-input\" placeholder=\"商品备注\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"add-footer\">\r\n\t\t\t\t\t<button @click=\"confirmAdd\" class=\"add-btn\">确认添加</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { store } from '@/uni_modules/uni-id-pages/common/store.js'\r\nconst goodsInfoObj = uniCloud.importObject('goodsInfoObj')\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tshowGoodsPopup: false,\r\n\t\t\tcurrentGoods: {},\r\n\t\t\tnewGoods: {\r\n\t\t\t\tgoods_name: '',\r\n\t\t\t\tgoods_price: '',\r\n\t\t\t\tgoods_notes: '',\r\n\t\t\t\tgoods_sn: ''\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tonShareAppMessage(res) {\r\n\t\t\tconsole.log(res);\r\n\t\t\tif (res.from === 'menu') { // button：来自页面内分享按钮\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttitle: '我的物品录',\r\n\t\t\t\t\tpath: '/pages/home/home',\r\n\t\t\t\t\timageUrl: 'https://env-00jxt6l7w3we.normal.cloudstatic.cn/showPic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-02%20170114.png'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonShareTimeline() {\r\n\t\t\treturn {\r\n\t\t\t\ttitle: '我的物品录',\r\n\t\t\t\timageUrl: 'https://env-00jxt6l7w3we.normal.cloudstatic.cn/showPic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202025-03-02%20170114.png'\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tcheckLogin() {\r\n\t\t\tif (!store.hasLogin) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-withoutpwd'\r\n\t\t\t\t})\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t\treturn true\r\n\t\t},\r\n\r\n\t\tgoToSearch() {\r\n\t\t\tif (!this.checkLogin()) return\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/home/search'\r\n\t\t\t})\r\n\t\t},\r\n\r\n\t\tpopopen() {\r\n\t\t\tif (!this.checkLogin()) return\r\n\t\t\tthis.$refs.addPopup.open()\r\n\t\t\tthis.newGoods = {\r\n\t\t\t\tgoods_name: '',\r\n\t\t\t\tgoods_price: '',\r\n\t\t\t\tgoods_notes: '',\r\n\t\t\t\tgoods_sn: ''\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tasync startScan() {\r\n\t\t\tif (!this.checkLogin()) return\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await uni.scanCode({\r\n\t\t\t\t\tscanType: ['barCode', 'qrCode']\r\n\t\t\t\t})\r\n\t\t\t\tthis.handleScanResult(res.result)\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '扫描失败',\r\n\t\t\t\t\ticon: 'error'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tasync handleScanResult(code) {\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await goodsInfoObj.findGoods(code)\r\n\t\t\t\tif (res.code === 0) {\r\n\t\t\t\t\tthis.currentGoods = res.data\r\n\t\t\t\t\tthis.showGoodsPopup = true\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.newGoods.goods_sn = code\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\tcontent: '没有该商品信息，是否添加？',\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\tthis.$refs.addPopup.open()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '获取商品信息失败',\r\n\t\t\t\t\ticon: 'error'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tasync confirmAdd() {\r\n\t\t\ttry {\r\n\t\t\t\tthis.newGoods.goods_price = parseFloat(this.newGoods.goods_price)\r\n\t\t\t\tconsole.log('this.newGoods.goods_price', this.newGoods.goods_price)\r\n\t\t\t\tif (isNaN(this.newGoods.goods_price) || this.newGoods.goods_price < 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '价格要求为数字且大于0',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tconst res = await goodsInfoObj.addGoods(this.newGoods)\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '添加成功',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t})\r\n\t\t\t\tthis.$refs.addPopup.close()\r\n\t\t\t\tthis.newGoods = {\r\n\t\t\t\t\tgoods_name: '',\r\n\t\t\t\t\tgoods_price: '',\r\n\t\t\t\t\tgoods_notes: '',\r\n\t\t\t\t\tgoods_sn: ''\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '添加失败',\r\n\t\t\t\t\ticon: 'error'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\tcloseAddPopup() {\r\n\t\t\tthis.$refs.addPopup.close()\r\n\t\t\tthis.newGoods = {\r\n\t\t\t\tgoods_name: '',\r\n\t\t\t\tgoods_price: '',\r\n\t\t\t\tgoods_notes: '',\r\n\t\t\t\tgoods_sn: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\trefreshGoods() {\r\n\t\t\t// 刷新商品信息\r\n\t\t\tthis.handleScanResult(this.currentGoods.goods_sn)\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style>\r\n.container {\r\n\tpadding: 40rpx;\r\n\tbackground: #f5f5f5;\r\n\tmin-height: 100vh;\r\n\tbox-sizing: border-box;\r\n}\r\n\r\n.search-box {\r\n\tbackground: #fff;\r\n\theight: 72rpx;\r\n\tborder-radius: 36rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tpadding: 0 32rpx;\r\n\tmargin-bottom: 80rpx;\r\n}\r\n\r\n.icon-search {\r\n\tfont-size: 40rpx;\r\n\tcolor: #999;\r\n\tmargin-right: 16rpx;\r\n}\r\n\r\n.placeholder {\r\n\tfont-size: 28rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.scan-section {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\tpadding: 61rpx 0;\r\n}\r\n\r\n.scan-button {\r\n\twidth: 320rpx;\r\n\theight: 320rpx;\r\n\tbackground: #007aff;\r\n\tborder-radius: 160rpx;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tbox-shadow: 0 16rpx 32rpx rgba(0, 122, 255, 0.2);\r\n\ttransition: all 0.3s;\r\n}\r\n\r\n.scan-button:active {\r\n\ttransform: scale(0.95);\r\n\tbox-shadow: 0 8rpx 16rpx rgba(0, 122, 255, 0.2);\r\n}\r\n\r\n.icon-scan {\r\n\tfont-size: 96rpx;\r\n\tcolor: #fff;\r\n\tmargin-bottom: 16rpx;\r\n}\r\n\r\n.scan-text {\r\n\tfont-size: 36rpx;\r\n\tcolor: #fff;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.uni-popup__wrapper {\r\n\twidth: 600rpx;\r\n}\r\n\r\n.add-popup {\r\n\tbackground: #fff;\r\n\tborder-radius: 32rpx;\r\n\twidth: 90%;\r\n\toverflow: hidden;\r\n}\r\n\r\n.add-header {\r\n\tpadding: 32rpx;\r\n\tborder-bottom: 1px solid #eee;\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n}\r\n\r\n.add-title {\r\n\tfont-size: 36rpx;\r\n\tfont-weight: 600;\r\n\tcolor: #333;\r\n}\r\n\r\n.add-body {\r\n\tpadding: 32rpx;\r\n}\r\n\r\n.add-input {\r\n\theight: 80rpx;\r\n\tborder: 2rpx solid #ddd;\r\n\tborder-radius: 16rpx;\r\n\tpadding: 0 24rpx;\r\n\tmargin-bottom: 24rpx;\r\n\tfont-size: 32rpx;\r\n}\r\n\r\n\r\n.add-input:focus {\r\n\tbox-shadow: 0 0 10rpx rgba(0, 0, 0, 0.1);\r\n\tborder-color: #007AFF;\r\n}\r\n\r\n.add-footer {\r\n\tpadding: 0 32rpx 32rpx;\r\n}\r\n\r\n.add-btn {\r\n\tbackground: #34c759;\r\n\tcolor: #fff;\r\n\theight: 80rpx;\r\n\tborder-radius: 16rpx;\r\n\tfont-size: 32rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n}\r\n</style>","import MiniProgramPage from 'D:/weixin_pj/扫一扫/pages/home/home.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","store","uni","res"],"mappings":";;;AAoDA,MAAA,eAAAA,cAAAA,GAAA,aAAA,cAAA;AAEA,MAAA,YAAA;AAAA,EACC,OAAA;AACC,WAAA;AAAA,MACC,gBAAA;AAAA,MACA,cAAA,CAAA;AAAA,MACA,UAAA;AAAA;QAEC,aAAA;AAAA,QACA,aAAA;AAAA;MAED;AAAA,IACD;AAAA;EAED,SAAA;AAAA;;AAGE,UAAA,IAAA,SAAA,QAAA;AACC,eAAA;AAAA;;UAGC,UAAA;AAAA,QACD;AAAA,MACD;AAAA;IAGD,kBAAA;AACC,aAAA;AAAA;QAEC,UAAA;AAAA;;;AAKD,UAAA,CAAAC,oCAAA,MAAA,UAAA;AACCC,sBAAAA,MAAA,WAAA;AAAA;;;MAID;AACA,aAAA;AAAA;;;;AAKAA,oBAAAA,MAAA,WAAA;AAAA;;;IAKD,UAAA;;;;AAGC,WAAA,WAAA;AAAA;QAEC,aAAA;AAAA,QACA,aAAA;AAAA;MAED;AAAA;IAGD,MAAA,YAAA;;;AAEC,UAAA;;;;AAIC,aAAA,iBAAA,IAAA,MAAA;AAAA,MACD,SAAA,GAAA;AACCA,sBAAAA,MAAA,UAAA;AAAA;;;MAID;AAAA;;AAIA,UAAA;AACC,cAAA,MAAA,MAAA,aAAA,UAAA,IAAA;AACA,YAAA,IAAA,SAAA,GAAA;;;;;AAKCA,wBAAAA,MAAA,UAAA;AAAA;;YAGC,SAAA,CAAAC,SAAA;AACC,kBAAAA,KAAA,SAAA;;cAEA;AAAA,YACD;AAAA;QAEF;AAAA,MACD,SAAA,GAAA;AACCD,sBAAAA,MAAA,UAAA;AAAA,UACC,OAAA;AAAA;;MAGF;AAAA;IAGD,MAAA,aAAA;AACC,UAAA;AACC,aAAA,SAAA,cAAA,WAAA,KAAA,SAAA,WAAA;;AAEA,YAAA,MAAA,KAAA,SAAA,WAAA,KAAA,KAAA,SAAA,cAAA,GAAA;AACCA,wBAAAA,MAAA,UAAA;AAAA,YACC,OAAA;AAAA;UAED,CAAA;;QAED;;;AAGAA,sBAAAA,MAAA,UAAA;AAAA;;;;AAKA,aAAA,WAAA;AAAA;UAEC,aAAA;AAAA,UACA,aAAA;AAAA;QAED;AAAA,MACD,SAAA,GAAA;AACCA,sBAAAA,MAAA,UAAA;AAAA;;;MAID;AAAA;IAED,gBAAA;;AAEC,WAAA,WAAA;AAAA;QAEC,aAAA;AAAA,QACA,aAAA;AAAA;MAED;AAAA;IAED,eAAA;;IAGA;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvMA,GAAG,WAAW,eAAe;"}