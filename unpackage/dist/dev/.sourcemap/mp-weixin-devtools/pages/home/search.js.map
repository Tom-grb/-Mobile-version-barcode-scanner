{"version":3,"names":["goodsInfoObj","common_vendor","er","importObject","_sfc_main","data","searchKeyword","goodsList","pageSize","page","hasMore","searched","showPopup","currentGoods","methods","goBack","index","navigateBack","clearSearch","handleSearch","_this","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","wrap","_callee$","_context","prev","next","trim","showToast","title","icon","abrupt","searchGoods","stop","_this2","_callee2","res","_callee2$","_context2","keyword","sent","concat","_toConsumableArray2","length","t0","loadMore","_this3","_callee3","_callee3$","_context3","showGoodsDetail","goods","refreshList","wx","createPage","MiniProgramPage"],"sources":["search.vue","cGFnZXMvaG9tZS9zZWFyY2gudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"search-container\">\r\n\t\t<!-- 搜索头部 -->\r\n\t\t<view class=\"search-header\">\r\n\t\t\t<view class=\"search-input-box\">\r\n\t\t\t\t<text class=\"iconfont icon-search\"></text>\r\n\t\t\t\t<input class=\"search-input\" type=\"text\" v-model=\"searchKeyword\" placeholder=\"搜索商品名称\"\r\n\t\t\t\t\tconfirm-type=\"search\" @confirm=\"handleSearch\" focus />\r\n\t\t\t\t<text v-if=\"searchKeyword\" class=\"clear-icon\" @click=\"clearSearch\">×</text>\r\n\t\t\t</view>\r\n\t\t\t<text class=\"cancel-btn\" @click=\"goBack\">取消</text>\r\n\t\t</view>\r\n\r\n\t\t<!-- 搜索结果列表 -->\r\n\t\t<scroll-view class=\"search-results\" scroll-y @scrolltolower=\"loadMore\" v-if=\"goodsList.length > 0\">\r\n\t\t\t<view class=\"goods-item\" v-for=\"item in goodsList\" :key=\"item._id\" @click=\"showGoodsDetail(item)\">\r\n\t\t\t\t<goods-item :item=\"item\"></goods-item>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 加载更多 -->\r\n\t\t\t<view class=\"load-more\" v-if=\"hasMore\">\r\n\t\t\t\t<text class=\"loading-text\">加载中...</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"no-more\" v-else>\r\n\t\t\t\t<text class=\"no-more-text\">没有更多了</text>\r\n\t\t\t</view>\r\n\t\t</scroll-view>\r\n\r\n\t\t<!-- 无搜索结果 -->\r\n\t\t<view class=\"empty-result\" v-else-if=\"searched\">\r\n\t\t\t<text class=\"empty-text\">未找到相关商品</text>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 商品详情弹窗 -->\r\n\t\t<goods-popup :show=\"showPopup\" :goods=\"currentGoods\" @update:show=\"showPopup = $event\" @refresh=\"refreshList\" />\r\n\t\t\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\r\n\r\n\tconst goodsInfoObj = uniCloud.importObject('goodsInfoObj')\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tsearchKeyword: '',\r\n\t\t\t\tgoodsList: [],\r\n\t\t\t\tpageSize: 10,\r\n\t\t\t\tpage: 1,\r\n\t\t\t\thasMore: true,\r\n\t\t\t\tsearched: false,\r\n\t\t\t\tshowPopup: false,\r\n\t\t\t\tcurrentGoods: {}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack()\r\n\t\t\t},\r\n\t\t\tclearSearch() {\r\n\t\t\t\tthis.searchKeyword = ''\r\n\t\t\t\tthis.goodsList = []\r\n\t\t\t\tthis.searched = false\r\n\t\t\t},\r\n\t\t\tasync handleSearch() {\r\n\t\t\t\tif (!this.searchKeyword.trim()) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请输入搜索关键词',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.page = 1\r\n\t\t\t\tthis.hasMore = true\r\n\t\t\t\tthis.searched = true\r\n\t\t\t\tawait this.searchGoods()\r\n\t\t\t},\r\n\t\t\tasync searchGoods() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst res = await goodsInfoObj.searchGoods({\r\n\t\t\t\t\t\tkeyword: this.searchKeyword,\r\n\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\tpageSize: this.pageSize\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tif (this.page === 1) {\r\n\t\t\t\t\t\tthis.goodsList = res.data\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.goodsList = [...this.goodsList, ...res.data]\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.hasMore = res.data.length === this.pageSize\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '搜索失败',\r\n\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync loadMore() {\r\n\t\t\t\tif (!this.hasMore) return\r\n\t\t\t\tthis.page++\r\n\t\t\t\tawait this.searchGoods()\r\n\t\t\t},\r\n\t\t\tshowGoodsDetail(goods) {\r\n\t\t\t\tthis.currentGoods = goods\r\n\t\t\t\tthis.showPopup = true\r\n\t\t\t},\r\n\t\t\trefreshList() {\r\n\t\t\t\tthis.handleSearch()\r\n\t\t\t\tthis.showPopup = false\r\n\t\t\t},\r\n\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.search-container {\r\n\t\tmin-height: 100vh;\r\n\t\tbackground: #f5f5f5;\r\n\t}\r\n\r\n\t.search-header {\r\n\t\tposition: sticky;\r\n\t\ttop: 0;\r\n\t\tz-index: 100;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 20rpx 32rpx;\r\n\t\tbackground: #fff;\r\n\t}\r\n\r\n\t.search-input-box {\r\n\t\tflex: 1;\r\n\t\theight: 72rpx;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-radius: 36rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 0 24rpx;\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\r\n\t.icon-search {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #999;\r\n\t\tmargin-right: 12rpx;\r\n\t}\r\n\r\n\t.search-input {\r\n\t\tflex: 1;\r\n\t\theight: 72rpx;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\r\n\t.clear-icon {\r\n\t\tfont-size: 40rpx;\r\n\t\tcolor: #999;\r\n\t\tpadding: 0 12rpx;\r\n\t}\r\n\r\n\t.cancel-btn {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #007AFF;\r\n\t}\r\n\r\n\t.search-results {\r\n\t\theight: calc(100vh - 112rpx);\r\n\t\tpadding: 20rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.load-more,\r\n\t.no-more {\r\n\t\ttext-align: center;\r\n\t\tpadding: 30rpx 0;\r\n\t}\r\n\r\n\t.loading-text,\r\n\t.no-more-text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.empty-result {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tpadding-top: 200rpx;\r\n\t}\r\n\r\n\t.empty-image {\r\n\t\twidth: 200rpx;\r\n\t\theight: 200rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t}\r\n\r\n\t.empty-text {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t/* 添加动画效果 */\r\n\t.goods-item {\r\n\t\tanimation: slideIn 0.3s ease-out;\r\n\t\tmargin-bottom: 17rpx;\r\n\t}\r\n\r\n\t@keyframes slideIn {\r\n\t\tfrom {\r\n\t\t\topacity: 0;\r\n\t\t\ttransform: translateY(20rpx);\r\n\t\t}\r\n\r\n\t\tto {\r\n\t\t\topacity: 1;\r\n\t\t\ttransform: translateY(0);\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/weixin_pj/扫一扫/pages/home/search.vue'\nwx.createPage(MiniProgramPage)"],"mappings":"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","ignoreList":[]}