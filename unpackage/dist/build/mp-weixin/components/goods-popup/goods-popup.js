"use strict";const o=require("../../common/vendor.js"),s=o.er.importObject("goodsInfoObj"),i={name:"goods-popup",props:{show:{type:Boolean,default:!1},goods:{type:Object,default:()=>({})}},data:()=>({isEditing:!1,localGoods:{}}),watch:{goods:{handler(o){this.localGoods=JSON.parse(JSON.stringify(o))},immediate:!0}},methods:{cancel(){this.isEditing=!1,this.$emit("update:show",!1)},handleEdit(){this.isEditing=!0},handleCancel(){this.isEditing=!1,this.localGoods=JSON.parse(JSON.stringify(this.goods))},async handleConfirm(){try{if(this.localGoods.goods_price=parseFloat(this.localGoods.goods_price),console.log("this.localGoods.goods_price",this.localGoods.goods_price),isNaN(this.localGoods.goods_price)||this.localGoods.goods_price<0)return void o.index.showToast({title:"价格要求为数字且大于0",icon:"none"});await s.updateGoods(this.localGoods),this.isEditing=!1,this.$emit("refresh")}catch(i){o.index.showToast({title:"更新失败",icon:"error"})}},async handleDelete(){o.index.showModal({title:"提示",content:"确定要删除该商品吗？",success:async i=>{if(i.confirm)try{await s.removeGoods({_id:this.goods._id}),o.index.showToast({title:"删除成功",icon:"success"}),this.cancel(),this.$emit("refresh")}catch(e){o.index.showToast({title:"删除失败",icon:"error"})}}})}}};const e=o._export_sfc(i,[["render",function(s,i,e,t,d,n){return o.e({a:e.show},e.show?o.e({b:o.o(((...o)=>n.cancel&&n.cancel(...o))),c:d.isEditing},d.isEditing?{d:d.localGoods.goods_sn,e:o.o((o=>d.localGoods.goods_sn=o.detail.value))}:{f:o.t(e.goods.goods_sn||"暂未填写")},{g:d.isEditing},d.isEditing?{h:d.localGoods.goods_name,i:o.o((o=>d.localGoods.goods_name=o.detail.value))}:{j:o.t(e.goods.goods_name)},{k:d.isEditing},d.isEditing?{l:d.localGoods.goods_price,m:o.o((o=>d.localGoods.goods_price=o.detail.value))}:{n:o.t(e.goods.goods_price)},{o:d.isEditing},d.isEditing?{p:d.localGoods.goods_notes,q:o.o((o=>d.localGoods.goods_notes=o.detail.value))}:{r:o.t(e.goods.goods_notes||"暂无备注")},{s:!d.isEditing},d.isEditing?{v:o.o(((...o)=>n.handleConfirm&&n.handleConfirm(...o))),w:o.o(((...o)=>n.handleCancel&&n.handleCancel(...o)))}:{t:o.o(((...o)=>n.handleEdit&&n.handleEdit(...o)))},{x:o.o(((...o)=>n.handleDelete&&n.handleDelete(...o))),y:o.o((()=>{})),z:o.o(((...o)=>n.cancel&&n.cancel(...o)))}):{})}]]);wx.createComponent(e);
