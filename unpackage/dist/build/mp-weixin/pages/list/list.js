"use strict";const o=require("../../common/vendor.js"),s=o.er.importObject("goodsInfoObj"),i={data:()=>({goodsList:[],page:1,pageSize:20,isLoading:!1,isNoMore:!1,showPopup:!1,currentGoods:{}}),onLoad(){this.getGoods()},onPullDownRefresh(){console.log(123),this.page=1,this.pageSize=20,this.goodsList=[],this.isNoMore=!1,this.getGoods()},onReachBottom(){console.log("bottom"),this.getGoods()},methods:{async getGoods(){if(this.isLoading||this.isNoMore)return;this.isLoading=!0;const i=await s.getGoodsList({page:this.page,pageSize:this.pageSize});if(0===i.code)i.data.length<this.pageSize&&(this.isNoMore=!0),this.goodsList=[...this.goodsList,...i.data],this.page++;else{if(-1===i.code)return o.index.showToast({title:"未登录/登录过期",icon:"none"}),this.isLoading=!1,o.index.stopPullDownRefresh(),void setTimeout((()=>{o.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd"})}),1e3);o.index.showToast({title:i.msg,icon:"none"})}o.index.stopPullDownRefresh(),this.isLoading=!1},showGoodsDetail(o){this.currentGoods=o,this.showPopup=!0},refreshList(){this.page=1,this.pageSize=20,this.goodsList=[],this.isNoMore=!1,this.getGoods(),this.showPopup=!1}}};if(!Array){(o.resolveComponent("goods-item")+o.resolveComponent("goods-popup"))()}Math||((()=>"../../components/goods-item/goods-item.js")+(()=>"../../components/goods-popup/goods-popup.js"))();const e=o._export_sfc(i,[["render",function(s,i,e,t,g,n){return o.e({a:g.goodsList.length>0},g.goodsList.length>0?o.e({b:o.f(g.goodsList,((s,i,e)=>({a:"21ffa888-0-"+e,b:o.p({item:s}),c:s._id,d:o.o((o=>n.showGoodsDetail(s)),s._id)}))),c:g.isLoading},(g.isLoading,{})):(0===g.goodsList.length&&g.isLoading||0!==g.goodsList.length||g.isLoading,{}),{d:0===g.goodsList.length&&g.isLoading,e:0===g.goodsList.length&&!g.isLoading,f:o.o((o=>g.showPopup=o)),g:o.o(n.refreshList),h:o.p({show:g.showPopup,goods:g.currentGoods})})}]]);wx.createPage(e);
