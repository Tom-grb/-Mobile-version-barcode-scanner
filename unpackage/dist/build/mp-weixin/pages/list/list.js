"use strict";const o=require("../../common/vendor.js"),s=o.er.importObject("goodsInfoObj"),e={data:()=>({goodsList:[],page:1,pageSize:20,isLoading:!1,isNoMore:!1,showPopup:!1,currentGoods:{}}),onLoad(){this.getGoods()},onPullDownRefresh(){console.log(123),this.page=1,this.pageSize=20,this.goodsList=[],this.isNoMore=!1,this.getGoods()},onReachBottom(){console.log("bottom"),this.getGoods()},methods:{async getGoods(){if(this.isLoading||this.isNoMore)return;this.isLoading=!0;const e=await s.getGoodsList({page:this.page,pageSize:this.pageSize});if(0===e.code)e.data.length<this.pageSize&&(this.isNoMore=!0),this.goodsList=[...this.goodsList,...e.data],this.page++;else{if(-1===e.code)return o.index.showToast({title:"未登录/登录过期",icon:"none"}),void setTimeout((()=>{o.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd"})}),1e3);o.index.showToast({title:e.msg,icon:"none"})}o.index.stopPullDownRefresh(),this.isLoading=!1},showGoodsDetail(o){this.currentGoods=o,this.showPopup=!0},refreshList(){this.page=1,this.pageSize=20,this.goodsList=[],this.isNoMore=!1,this.getGoods(),this.showPopup=!1}}};if(!Array){(o.resolveComponent("goods-item")+o.resolveComponent("goods-popup"))()}Math||((()=>"../../components/goods-item/goods-item.js")+(()=>"../../components/goods-popup/goods-popup.js"))();const i=o._export_sfc(e,[["render",function(s,e,i,t,n,d){return o.e({a:n.goodsList.length>0},n.goodsList.length>0?o.e({b:o.f(n.goodsList,((s,e,i)=>({a:"21ffa888-0-"+i,b:o.p({item:s}),c:s._id,d:o.o((o=>d.showGoodsDetail(s)),s._id)}))),c:n.isLoading},(n.isLoading,{})):{},{d:o.o((o=>n.showPopup=o)),e:o.o(d.refreshList),f:o.p({show:n.showPopup,goods:n.currentGoods})})}]]);wx.createPage(i);
