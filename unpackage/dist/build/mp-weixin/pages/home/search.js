"use strict";const o=require("../../common/vendor.js"),e=o.er.importObject("goodsInfoObj"),s={data:()=>({searchKeyword:"",goodsList:[],pageSize:10,page:1,hasMore:!0,searched:!1,showPopup:!1,currentGoods:{}}),methods:{goBack(){o.index.navigateBack()},clearSearch(){this.searchKeyword="",this.goodsList=[],this.searched=!1},async handleSearch(){this.searchKeyword.trim()?(this.page=1,this.hasMore=!0,this.searched=!0,await this.searchGoods()):o.index.showToast({title:"请输入搜索关键词",icon:"none"})},async searchGoods(){try{const s=await e.searchGoods({keyword:this.searchKeyword,page:this.page,pageSize:this.pageSize});if(-1===s.code)return o.index.showToast({title:"未登录/登录过期",icon:"none"}),void setTimeout((()=>{o.index.navigateTo({url:"/uni_modules/uni-id-pages/pages/login/login-withoutpwd"})}),1e3);1===this.page?this.goodsList=s.data:this.goodsList=[...this.goodsList,...s.data],this.hasMore=s.data.length===this.pageSize}catch(s){o.index.showToast({title:"搜索失败",icon:"error"})}},async loadMore(){this.hasMore&&(this.page++,await this.searchGoods())},showGoodsDetail(o){this.currentGoods=o,this.showPopup=!0},refreshList(){this.handleSearch(),this.showPopup=!1}}};if(!Array){(o.resolveComponent("goods-item")+o.resolveComponent("goods-popup"))()}Math||((()=>"../../components/goods-item/goods-item.js")+(()=>"../../components/goods-popup/goods-popup.js"))();const a=o._export_sfc(s,[["render",function(e,s,a,t,h,i){return o.e({a:o.o(((...o)=>i.handleSearch&&i.handleSearch(...o))),b:h.searchKeyword,c:o.o((o=>h.searchKeyword=o.detail.value)),d:h.searchKeyword},h.searchKeyword?{e:o.o(((...o)=>i.clearSearch&&i.clearSearch(...o)))}:{},{f:o.o(((...o)=>i.goBack&&i.goBack(...o))),g:h.goodsList.length>0},h.goodsList.length>0?o.e({h:o.f(h.goodsList,((e,s,a)=>({a:"78dc3531-0-"+a,b:o.p({item:e}),c:e._id,d:o.o((o=>i.showGoodsDetail(e)),e._id)}))),i:h.hasMore},(h.hasMore,{}),{j:o.o(((...o)=>i.loadMore&&i.loadMore(...o)))}):(h.searched,{}),{k:h.searched,l:o.o((o=>h.showPopup=o)),m:o.o(i.refreshList),n:o.p({show:h.showPopup,goods:h.currentGoods})})}]]);wx.createPage(a);
