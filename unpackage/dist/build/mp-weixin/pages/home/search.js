"use strict";const o=require("../../common/vendor.js"),e=require("../../utils/tool.js"),s=o.er.importObject("goodsInfoObj"),a={data:()=>({searchKeyword:"",goodsList:[],pageSize:10,page:1,hasMore:!0,searched:!1,showPopup:!1,currentGoods:{}}),methods:{formatMillisecondsToDate:e.formatMillisecondsToDate,goBack(){o.index.navigateBack()},clearSearch(){this.searchKeyword="",this.goodsList=[],this.searched=!1},async handleSearch(){this.searchKeyword.trim()?(this.page=1,this.hasMore=!0,this.searched=!0,await this.searchGoods()):o.index.showToast({title:"请输入搜索关键词",icon:"none"})},async searchGoods(){try{const o=await s.searchGoods({keyword:this.searchKeyword,page:this.page,pageSize:this.pageSize});1===this.page?this.goodsList=o.data:this.goodsList=[...this.goodsList,...o.data],this.hasMore=o.data.length===this.pageSize}catch(e){o.index.showToast({title:"搜索失败",icon:"error"})}},async loadMore(){this.hasMore&&(this.page++,await this.searchGoods())},showGoodsDetail(o){this.currentGoods=o,this.showPopup=!0},refreshList(){this.handleSearch(),this.showPopup=!1}}};if(!Array){o.resolveComponent("goods-popup")()}Math;const t=o._export_sfc(a,[["render",function(e,s,a,t,r,h){return o.e({a:o.o(((...o)=>h.handleSearch&&h.handleSearch(...o))),b:r.searchKeyword,c:o.o((o=>r.searchKeyword=o.detail.value)),d:r.searchKeyword},r.searchKeyword?{e:o.o(((...o)=>h.clearSearch&&h.clearSearch(...o)))}:{},{f:o.o(((...o)=>h.goBack&&h.goBack(...o))),g:r.goodsList.length>0},r.goodsList.length>0?o.e({h:o.f(r.goodsList,((e,s,a)=>({a:o.t(e.goods_name),b:o.t(e.goods_price),c:o.t(e.goods_sn),d:o.t(h.formatMillisecondsToDate(e.last_modify_date)),e:e._id,f:o.o((o=>h.showGoodsDetail(e)),e._id)}))),i:r.hasMore},(r.hasMore,{}),{j:o.o(((...o)=>h.loadMore&&h.loadMore(...o)))}):(r.searched,{}),{k:r.searched,l:o.o((o=>r.showPopup=o)),m:o.o(h.refreshList),n:o.p({show:r.showPopup,goods:r.currentGoods})})}]]);wx.createPage(t);
